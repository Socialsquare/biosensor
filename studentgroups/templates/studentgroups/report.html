{% extends "base.html" %}
{% load bootstrap3 %}
{% load static %}

{% block head_title %}
{% if report %} Rediger rapport {% else %} Opret rapport{% endif %} | {{ block.super }}
{% endblock %}

{% block summernote_scripts %}
{{ form.media }}
{% endblock %}

{% block main %}

<h1>
  {% if report %} Rediger rapport {% else %} Opret rapport for {{biosensor.name}}{% endif %}
</h1>

<form method="post"
  {% if report %}
    action="{% url 'studentgroups:edit_report' biosensor.id report.id %}"
  {% else %}
    action="{% url 'studentgroups:new_report' biosensor.id %}"
  {% endif %}
  enctype="multipart/form-data">

  <div class="row">
    <div class="col-md-8">
      {% csrf_token %}
      <div class="m-y-2">
        {% bootstrap_field form.resume %}
      </div>
      <div class="m-y-2">
        {% bootstrap_field form.method %}
      </div>
      <div class="m-y-2">
        {% bootstrap_field form.results %}
      </div>
      <div class="m-y-2">
        {% bootstrap_field form.conclusion %}
      </div>
      {% if report %}
        <button class="btn btn-primary" type="submit">Gem ændringer</button>
      {% else %}
        <button class="btn btn-primary" type="submit">Opret rapport</button>
      {% endif %}
      <a class="btn btn-link" href="{% url 'studentgroups:dashboard' %}">Annullér</a>
    </div>

    <div class="col-md-4">
      <h2 class="m-t-2">Kategori</h2>
      <p>{{biosensor.category.name}}</p>

      <h2>Detektor gen</h2>
      <p><a href="{% url 'biobricks:show' biosensor.detector.slug %}">{{biosensor.detector.name}}</a></p>

      <h2>Respons gen</h2>
      <p><a href="{% url 'biobricks:show' biosensor.responder.slug %}">{{biosensor.responder.name}}</a></p>

      <h2>Billede</h2>
      <div class="form-group">
        {% if report and report.image %}
          <p>
            <a target="_blank" href="{{report.image.url}}">Hent billedet</a>
            <span class="upload-mode">eller <a href="#">upload et nyt</a></span>
          </p>
        {% endif %}
        <div class="row bootstrap3-multi-input" {% if report and report.image and not form.image.errors %}style="display: none" {% endif %}>
          <div class="col-xs-12">
            <input class="btn btn-secondary" name="image" title="" type="file" />
            <p>{{form.image.errors}}</p>
          </div>
        </div>
      </div>

      <h2>Regneark</h2>
      <div class="form-group">
        {% if report and report.attachment %}
          <p>
            <a target="_blank" href="{{report.attachment.url}}">Download fil</a>
            <span class="upload-mode">eller <a href="#">upload en ny</a></span>
          </p>
        {% endif %}
        <div class="row bootstrap3-multi-input" {% if report and report.attachment and not form.image.errors %}style="display: none" {% endif %}>
          <div class="col-xs-12">
            <input class="btn btn-secondary" name="attachment" title="" type="file" />
            {{form.attachment.errors}}
          </div>
        </div>
      </div>
    </div>
  </div>
</form>

{% endblock %}
